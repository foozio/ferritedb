name: Update Contributors

on:
  push:
    branches: [ main ]
  pull_request:
    types: [ closed ]
  schedule:
    # Run weekly on Sundays at 00:00 UTC
    - cron: '0 0 * * 0'
  workflow_dispatch:

jobs:
  update-contributors:
    if: github.event_name == 'schedule' || github.event_name == 'workflow_dispatch' || (github.event_name == 'pull_request' && github.event.pull_request.merged == true) || github.event_name == 'push'
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        fetch-depth: 0

    - name: Generate contributors list
      uses: wow-actions/contributors-list@v1
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        path: CONTRIBUTORS.md
        template: |
          # Contributors

          This file recognizes all the amazing people who have contributed to FerriteDB.

          ## ğŸ† Maintainer

          ### [@foozio](https://github.com/foozio)
          **Project Creator & Lead Maintainer**

          - ğŸš€ **Project Leadership**: Founded FerriteDB and drives the overall vision and roadmap
          - ğŸ—ï¸ **Core Architecture**: Designed and implemented the foundational architecture
          - ğŸ” **Authentication System**: Built the JWT-based authentication with Argon2 password hashing
          - ğŸ›¡ï¸ **Rules Engine**: Created the CEL-like rules engine for access control
          - ğŸ“Š **Dynamic Collections**: Implemented the dynamic schema system
          - ğŸ”„ **Complete Rebrand**: Led the comprehensive RustBase to FerriteDB rebrand
          - ğŸ“ **Documentation**: Authored comprehensive documentation and guides
          - ğŸ§ª **Testing & Validation**: Established testing frameworks and validation processes

          **Contributions**: Architecture, Authentication, Rules Engine, Dynamic Collections, CLI Tools, Documentation, Project Management

          ---

          ## ğŸŒŸ Contributors

          Thanks to all the amazing people who have contributed to FerriteDB:

          {{contributors}}

          ---

          ## ğŸ¤ How to Become a Contributor

          We welcome contributions of all kinds! Here are some ways you can contribute:

          ### ğŸ”§ Code Contributions
          - **Backend Development**: Rust development on core features
          - **Frontend Development**: Admin UI improvements and new features  
          - **CLI Tools**: Command-line interface enhancements
          - **API Development**: REST API and WebSocket improvements
          - **Performance Optimization**: Database queries, caching, and efficiency improvements

          ### ğŸ“š Documentation
          - **User Guides**: Help improve our documentation
          - **API Documentation**: Enhance API docs and examples
          - **Tutorials**: Create step-by-step tutorials
          - **Translations**: Help translate documentation

          ### ğŸ§ª Testing & Quality
          - **Unit Tests**: Write comprehensive test coverage
          - **Integration Tests**: End-to-end testing scenarios
          - **Performance Testing**: Benchmarking and load testing
          - **Security Testing**: Security audits and vulnerability testing

          ### ğŸ› Bug Reports & Features
          - **Bug Reports**: Help identify and report issues
          - **Feature Requests**: Suggest new features and improvements
          - **User Experience**: Provide feedback on usability

          ### ğŸŒ Community
          - **Community Support**: Help other users in discussions
          - **Content Creation**: Blog posts, videos, tutorials
          - **Advocacy**: Spread the word about FerriteDB

          ---

          ## ğŸ… Recognition Levels

          ### ğŸ¥‡ Maintainer
          - Project leadership and major architectural decisions
          - Commit access and release management
          - Community leadership and mentoring

          ### ğŸ¥ˆ Core Contributor
          - Significant ongoing contributions to the codebase
          - Regular participation in project discussions
          - Mentoring new contributors

          ### ğŸ¥‰ Regular Contributor
          - Multiple merged pull requests
          - Consistent participation in the community
          - Valuable feedback and suggestions

          ### ğŸŒŸ Community Member
          - Bug reports and feature requests
          - Documentation improvements
          - Community support and advocacy

          ---

          ## ğŸ™ Special Thanks

          Special thanks to all the projects and communities that inspired FerriteDB:

          - **[PocketBase](https://pocketbase.io/)** - Inspiration for the backend-as-a-service concept
          - **[Supabase](https://supabase.com/)** - Modern backend service architecture
          - **[Rust Community](https://www.rust-lang.org/community)** - Amazing ecosystem and support
          - **[Axum](https://github.com/tokio-rs/axum)** - Excellent web framework
          - **[SQLite](https://sqlite.org/)** - Reliable embedded database
          - **[Tokio](https://tokio.rs/)** - Async runtime foundation

          ---

          ## ğŸ“ Contributor Agreement

          By contributing to FerriteDB, you agree that your contributions will be licensed under the same MIT License that covers the project. You also confirm that you have the right to submit the work under this license.

          ---

          **Want to join this list?** Check out our [Contributing Guide](CONTRIBUTING.md) and start contributing today!

          *Last updated: {{date}}*
        commit: true
        commit-message: 'docs: update contributors list'
        commit-email: 'action@github.com'
        commit-name: 'GitHub Action'

    - name: Create Pull Request
      if: github.event_name == 'schedule'
      uses: peter-evans/create-pull-request@v5
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        commit-message: 'docs: update contributors list'
        title: 'docs: Update contributors list'
        body: |
          This PR automatically updates the contributors list.
          
          - Updates CONTRIBUTORS.md with latest contributor information
          - Generated automatically by GitHub Actions
        branch: update-contributors
        delete-branch: true